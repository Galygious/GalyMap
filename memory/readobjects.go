package memory

import (
	"GalyMap/globals"
	"GalyMap/utils"
	"encoding/binary"
)

// ReadObjects reads objects from the game process and updates the global gameObjects list
func ReadObjects(d2r *utils.ClassMemory, startingOffset int, currentHoveringUnitId uint32, levelNo int) {
	globals.GameObjects = []utils.Object{} // Initialize the global gameObjects list

	baseAddress := d2r.BaseAddress + uintptr(startingOffset) + (2 * 1024)
	unitTableBuffer, err := d2r.ReadRaw(baseAddress, 128*8)
	utils.IfError(err, "Failed to read unit table buffer")

	for i := 0; i < 128; i++ {
		offset := 8 * i
		objectUnit := int64(binary.LittleEndian.Uint64(unitTableBuffer[offset : offset+8]))

		for objectUnit > 0 {
			objectBuffer, err := d2r.ReadRaw(uintptr(objectUnit), 0x150+8) // Read a larger chunk of memory
			utils.IfError(err, "Failed to read object buffer")

			itemType, err := utils.ReadBufferAndAssert[uint32](objectBuffer, 0x00, "UInt")
			utils.IfError(err, "Failed to read item type")

			if itemType == 2 { // 2 == object
				txtFileNo, err := utils.ReadBufferAndAssert[uint32](objectBuffer, 0x04, "UInt")
				utils.IfError(err, "Failed to read txtFileNo")

				mode, err := utils.ReadBufferAndAssert[uint32](objectBuffer, 0x0c, "UInt")
				utils.IfError(err, "Failed to read mode")

				isPortal, _ := IsPortal(int(txtFileNo))
				isShrine, _ := IsShrine(int(txtFileNo))
				isRedPortal, _ := IsRedPortal(int(txtFileNo))
				isChest, _ := IsChest(int(txtFileNo))

				if isPortal || isShrine || isRedPortal || isChest {
					unitId, err := utils.ReadBufferAndAssert[uint32](objectBuffer, 0x08, "UInt")
					utils.IfError(err, "Failed to read unitId")

					interactType, err := utils.ReadBufferAndAssert[uint8](objectBuffer, 0x18+0x08, "UChar")
					utils.IfError(err, "Failed to read interactType")

					shrineFlag, err := utils.ReadBufferAndAssert[uint16](objectBuffer, 0x18+0x09, "UShort")
					utils.IfError(err, "Failed to read shrineFlag")

					name := GetObjectName(int(txtFileNo))

					x, err := utils.ReadBufferAndAssert[uint16](objectBuffer, 0x38+0x10, "UShort")
					utils.IfError(err, "Failed to read x")

					y, err := utils.ReadBufferAndAssert[uint16](objectBuffer, 0x38+0x14, "UShort")
					utils.IfError(err, "Failed to read y")

					var shrineType, chestState, ownerName string
					if isShrine {
						shrineType = GetShrineType(int(interactType))
					}
					if isChest {
						chestState = GetChestState(int(interactType))
					}
					if isPortal {
						// Attempt to read a null-terminated string of up to 32 bytes
						ownerNameBuffer := objectBuffer[0x18+0x34 : 0x18+0x34+32]
						ownerName = utils.ReadNullTerminatedString(ownerNameBuffer)
					}

					gameObject := utils.Object{
						TxtFileNo:    txtFileNo,
						Name:         name,
						Mode:         mode,
						IsChest:      isChest,
						ChestState:   chestState,
						IsPortal:     isPortal,
						IsRedPortal:  isRedPortal,
						OwnerName:    ownerName,
						InteractType: interactType,
						IsShrine:     isShrine,
						ShrineType:   shrineType,
						Pos:          utils.ObjectPosition{X: x, Y: y},
						LevelNo:      levelNo,
						UnitID:       unitId,
						ShrineFlag:   shrineFlag,
					}
					globals.GameObjects = append(globals.GameObjects, gameObject)
				}

				objectUnit, err = utils.ReadBufferAndAssert[int64](objectBuffer, 0x150, "Int64")
				utils.IfError(err, "Failed to read next objectUnit")
			}
		}
	}
}

// Getters

func IsChest(txtFileNo int) (bool, string) {
	name, exists := ChestNames[txtFileNo]
	return exists, name
}

func IsShrine(txtFileNo int) (bool, string) {
	name, exists := ShrineMap[txtFileNo]
	return exists, name
}

func IsPortal(txtFileNo int) (bool, string) {
	name, exists := PortalsMap[txtFileNo]
	return exists, name
}

func IsRedPortal(txtFileNo int) (bool, string) {
	name, exists := RedPortalsMap[txtFileNo]
	return exists, name
}

func GetShrineType(interactType int) string {
	if val, exists := ShrineTypesMap[interactType]; exists {
		return val
	}
	return ""
}

func GetObjectName(txtFileNo int) string {
	if val, exists := ObjectNamesMap[txtFileNo]; exists {
		return val
	}
	return ""
}

func GetChestState(interactType int) string {
	if val, exists := ChestStatesMap[interactType]; exists {
		return val
	}
	return ""
}

// Maps
var ChestNames = map[int]string{
	1:   "Casket5",
	3:   "Casket6",
	5:   "LargeChestRight",
	6:   "LargeChestLeft",
	50:  "CasketR",
	51:  "CasketL",
	53:  "Casket",
	54:  "RogueCorpse1",
	55:  "RogueCorpse2",
	56:  "RogueCorpseRolling",
	57:  "CorpseOnStick1",
	58:  "CorpseOnStick2",
	79:  "Casket3",
	87:  "TombLargeChestL",
	88:  "TombLargeChestR",
	89:  "Sarcophagus",
	125: "InnerHellHiddenStash",
	126: "InnerHellSkullPile",
	127: "InnerHellHiddenStash2",
	128: "InnerHellHiddenStash3",
	139: "Act1LargeChestRight",
	140: "Act1TallChestRight",
	141: "Act1MediumChestRight",
	144: "Act1LargeChest1",
	146: "Act2MediumChestRight",
	147: "Act2LargeChestRight",
	148: "Act2LargeChestLeft",
	154: "GuardCorpse",
	155: "HiddenStashRock",
	158: "SkeletonCorpseIsAnOxymoron",
	159: "HiddenStashRockB",
	169: "HollowLog",
	171: "SkeletonCorpseIsStillAnOxymoron",
	174: "LooseRock",
	175: "LooseBoulder",
	176: "MediumChestLeft",
	177: "LargeChestLeft2",
	178: "GuardCorpseOnAStick",
	181: "JungleChest",
	182: "TombCoffin",
	183: "JungleMediumChestLeft",
	185: "JungleStashObject1",
	186: "JungleStashObject2",
	187: "JungleStashObject3",
	188: "JungleStashObject4",
	198: "TallChestLeft",
	203: "MephistoLair",
	204: "StashBox",
	205: "StashAltar",
	223: "Cocoon",
	224: "Cocoon2",
	225: "SkullPileH1",
	240: "Gchest1L",
	241: "Gchest2R",
	242: "Gchest3R",
	243: "GLchest3L",
	244: "SewersRatNest",
	247: "Act1BedBed1",
	248: "Act1BedBed2",
	266: "MaggotLairGooPile",
	268: "WirtCorpse",
	270: "GuardCorpse2",
	271: "DeadVillager1",
	272: "DeadVillager2",
	274: "TinyPixelShapedThingie",
	284: "Act2TombAnubisCoffin",
	314: "HaremDeadGuard1",
	315: "HaremDeadGuard2",
	316: "HaremDeadGuard3",
	317: "HaremDeadGuard4",
	326: "Act3SewerDeadBody",
	329: "MafistoLargeChestLeft",
	330: "MafistoLargeChestRight",
	331: "MafistoMediumChestLeft",
	332: "MafistoMediumChestRight",
	333: "SpiderLairLargeChestLeft",
	334: "SpiderLairTallChestLeft",
	335: "SpiderLairMediumChestRight",
	336: "SpiderLairTallChestRight",
	354: "HoradricCubeChest",
	355: "HoradricScrollChest",
	356: "StaffOfKingsChest",
	360: "DungeonRockPile",
	371: "LargeChestR",
	372: "InnerHellBoneChest",
	380: "BurningTrappedSoul1",
	381: "BurningTrappedSoul2",
	383: "StuckedTrappedSoul1",
	384: "StuckedTrappedSoul2",
	387: "ArcaneLargeChestLeft",
	388: "ArcaneCasket",
	389: "ArcaneLargeChestRight",
	390: "ArcaneSmallChestLeft",
	391: "ArcaneSmallChestRight",
	397: "SparklyChest",
	405: "KhalimChest1",
	406: "KhalimChest2",
	407: "KhalimChest3",
	413: "ExpansionChestRight",
	416: "ExpansionHiddenStash",
	420: "ExpansionWoodChestLeft",
	424: "BurialChestLeft",
	425: "BurialChestRight",
	430: "ExpansionChestLeft",
	431: "ExpansionWoodChestRight",
	432: "ExpansionSmallChestLeft",
	433: "ExpansionSmallChestRight",
	454: "ExpansionExplodingChest",
	455: "ExpansionSpecialChest",
	463: "IceCaveHiddenStash",
	466: "IceCaveEvilUrn",
	485: "WorldstoneTomb1",
	486: "WorldstoneTomb2",
	487: "WorldstoneTomb3",
	501: "ExpansionSnowyWoodChestLeft",
	502: "ExpansionSnowyWoodChestRight",
	504: "ExpansionSnowyWoodChest2Left",
	505: "ExpansionSnowyWoodChest2Right",
	518: "WorldstoneMrBox",
	524: "WorldstoneTomb1Left",
	525: "WorldstoneTomb2Left",
	526: "WorldstoneTomb3Left",
	529: "RedBaalsLairTomb1",
	530: "RedBaalsLairTomb1Left",
	531: "RedBaalsLairTomb2",
	532: "RedBaalsLairTomb2Left",
	533: "RedBaalsLairTomb3",
	534: "RedBaalsLairTomb3Left",
	535: "RedBaalsLairMrBox",
	540: "ExpansionDeadPerson1",
	541: "TempleGroundTomb",
	544: "TempleGroundTombLeft",
	545: "ExpansionDeadPerson2",
	556: "ExpansionDeadPerson3",
	580: "GoodChest",
	581: "NotSoGoodChest",
}

var ShrineTypesMap = map[int]string{
	1:  "ShrId1",
	2:  "ShrId2",
	3:  "ShrId3",
	4:  "ShrId4",
	5:  "ShrId5",
	6:  "ShrId6",
	7:  "ShrId7",
	8:  "ShrId8",
	9:  "ShrId9",
	10: "ShrId10",
	11: "ShrId11",
	12: "ShrId12",
	13: "ShrId13",
	14: "ShrId14",
	15: "ShrId15",
	16: "ShrId16",
	17: "ShrId17",
	18: "ShrId18",
	19: "ShrId19",
	20: "ShrId20",
	21: "ShrId21",
	22: "ShrId22",
}

var ShrineMap = map[int]string{
	2:   "DeerShrine",
	77:  "ShrineAltar",
	81:  "ForestAltar",
	83:  "HornShrine",
	84:  "HealingWell",
	85:  "BullShrine",
	86:  "SteleShrine",
	93:  "InnerHellManaShrine1",
	96:  "InnerHellHealthShrine1",
	97:  "InnerHellMagicShrine1",
	109: "PalaceShrine",
	116: "SnakeWomanShrine",
	120: "ShrineHealthDungeon",
	123: "InnerHellMagicShrine2",
	124: "InnerHellMagicShrine3",
	133: "ShrineMagicArcaneSanctuary1",
	134: "DesertShrine00",
	135: "DesertShrine01",
	136: "DesertShrine02",
	149: "TaintedSunShrine",
	150: "DesertShrine03",
	151: "DesertShrine04",
	164: "ManaWell1",
	165: "ManaWell2",
	166: "ManaWell3",
	167: "ManaWell4",
	168: "ManaWell5",
	172: "ShrineHealth",
	173: "ShrineMana",
	184: "JungleShrine2",
	190: "JungleShrine3",
	191: "JungleShrine4",
	197: "JungleShrine5",
	199: "MephistoShrine1",
	200: "MephistoShrine2",
	201: "MephistoShrine3",
	202: "MephistoShrine4",
	206: "MephistoShrine5",
	226: "HellShrine1",
	231: "OuterShrineHell2",
	232: "OuterShrineHell3",
	249: "HellManaWell1",
	260: "HolyShrineAct1",
	262: "Act1CathedralShrine",
	263: "Act1JailShrine",
	264: "Act1JailHealthShrine",
	265: "Act1JailManaShrine",
	275: "HealthShrineCavesAct1",
	276: "ManaShrineCavesAct1",
	277: "MagicShrinesCavesAct1",
	278: "ShrineManaDungeon",
	279: "ShrineMagicSewer",
	280: "ShrineHealthSewer",
	281: "ShrineManaSewer",
	282: "ShrineMagicSewer2",
	299: "HaremShrine1",
	300: "HaremShrine2",
	301: "MaggotShrineHealth",
	302: "MaggotShrineMana",
	303: "ShrineMagicArcaneSanctuary2",
	319: "ShrineArcaneHealth",
	320: "ShrineArcaneMana",
	325: "ShrineMagicSewer3",
	343: "ShrineManaKurast",
	344: "ShrineHealthKurast",
	361: "DungeonShrineMagic",
	414: "ShrineWildernessExp1",
	415: "ShrineWildernessExp2",
	421: "ShrineAltarExp",
	422: "ShrineManaExp",
	423: "ShrineHealthExp",
	427: "ShrineWildernessExp3",
	428: "ShrineWildernessExp4",
	464: "ShrineHealthIceCave",
	465: "ShrineManaIceCave",
	472: "ShrineMagicIceCave",
	479: "ShrineMagicIceCave2",
	483: "ShrineBaal1",
	484: "ShrineBaal2",
	488: "ShrineBaalMagic",
	491: "ShrineBaalMana",
	492: "ShrineBaalHealth",
	495: "ShrineMagicSnow1",
	497: "ShrineMagicSnow2",
	499: "ShrineBallMagic2",
	503: "ShrineBaalMagic3",
	509: "ShrineTempleMagic1",
	512: "ShrineTempleMagic2",
	520: "ShrineTempleMagic3",
	521: "ShrineTempleHealth",
	522: "ShrineTempleMana",
	574: "DesertShrineArmor",
	575: "DesertShrineCombat",
	576: "DesertShrineResist",
	577: "DesertShrineSkill",
	578: "DesertShrineRecharge",
	579: "DesertShrineStamina",
}

var PortalsMap = map[int]string{
	59:  "townPortal",
	100: "DurielsLairPortal",
	563: "BaalsPortal",
}

var RedPortalsMap = map[int]string{
	60:  "PermanentTownPortal",
	565: "LastPortal",
	566: "LastLastPortal",
	569: "BaalsPortal2",
	298: "ArcaneSanctuaryPortal",
	377: "GuildPortal",
}

var ObjectNamesMap = map[int]string{
	1:   "Casket5",
	2:   "Shrine",
	3:   "Casket6",
	4:   "LargeUrn1",
	5:   "LargeChestRight",
	6:   "LargeChestLeft",
	7:   "Barrel",
	8:   "TowerTome",
	9:   "Urn2",
	10:  "Bench",
	11:  "BarrelExploding",
	12:  "RogueFountain",
	13:  "DoorGateLeft",
	14:  "DoorGateRight",
	15:  "DoorWoodenLeft",
	16:  "DoorWoodenRight",
	17:  "CairnStoneAlpha",
	18:  "CairnStoneBeta",
	19:  "CairnStoneGamma",
	20:  "CairnStoneDelta",
	21:  "CairnStoneLambda",
	22:  "CairnStoneTheta",
	23:  "DoorCourtyardLeft",
	24:  "DoorCourtyardRight",
	25:  "DoorCathedralDouble",
	26:  "CainGibbet",
	27:  "DoorMonasteryDoubleRight",
	28:  "HoleAnim",
	29:  "Brazier",
	30:  "InifussTree",
	31:  "Fountain",
	32:  "Crucifix",
	33:  "Candles1",
	34:  "Candles2",
	35:  "Standard1",
	36:  "Standard2",
	37:  "Torch1Tiki",
	38:  "Torch2Wall",
	39:  "RogueBonfire",
	40:  "River1",
	41:  "River2",
	42:  "River3",
	43:  "River4",
	44:  "River5",
	45:  "AmbientSoundGenerator",
	46:  "Crate",
	47:  "AndarielDoor",
	48:  "RogueTorch1",
	49:  "RogueTorch2",
	50:  "CasketR",
	51:  "CasketL",
	52:  "Urn3",
	53:  "Casket",
	54:  "RogueCorpse1",
	55:  "RogueCorpse2",
	56:  "RogueCorpseRolling",
	57:  "CorpseOnStick1",
	58:  "CorpseOnStick2",
	59:  "TownPortal",
	60:  "PermanentTownPortal",
	61:  "InvisibleObject",
	62:  "DoorCathedralLeft",
	63:  "DoorCathedralRight",
	64:  "DoorWoodenLeft2",
	65:  "InvisibleRiverSound1",
	66:  "InvisibleRiverSound2",
	67:  "Ripple1",
	68:  "Ripple2",
	69:  "Ripple3",
	70:  "Ripple4",
	71:  "ForestNightSound1",
	72:  "ForestNightSound2",
	73:  "YetiDung",
	74:  "TrappDoor",
	75:  "DoorByAct2Dock",
	76:  "SewerDrip",
	77:  "HealthOrama",
	78:  "InvisibleTownSound",
	79:  "Casket3",
	80:  "Obelisk",
	81:  "ForestAltar",
	82:  "BubblingPoolOfBlood",
	83:  "HornShrine",
	84:  "HealingWell",
	85:  "BullHealthShrine",
	86:  "SteleDesertMagicShrine",
	87:  "TombLargeChestL",
	88:  "TombLargeChestR",
	89:  "Sarcophagus",
	90:  "DesertObelisk",
	91:  "TombDoorLeft",
	92:  "TombDoorRight",
	93:  "InnerHellManaShrine",
	94:  "LargeUrn4",
	95:  "LargeUrn5",
	96:  "InnerHellHealthShrine",
	97:  "InnerHellShrine",
	98:  "TombDoorLeft2",
	99:  "TombDoorRight2",
	100: "DurielsLairPortal",
	101: "Brazier3",
	102: "FloorBrazier",
	103: "Flies",
	104: "ArmorStandRight",
	105: "ArmorStandLeft",
	106: "WeaponRackRight",
	107: "WeaponRackLeft",
	108: "Malus",
	109: "PalaceHealthShrine",
	110: "Drinker",
	111: "Fountain1",
	112: "Gesturer",
	113: "DesertFountain",
	114: "Turner",
	115: "Fountain3",
	116: "SnakeWomanShrine",
	117: "JungleTorch",
	118: "Fountain4",
	119: "WaypointPortal",
	120: "DungeonHealthShrine",
	121: "JerhynPlaceHolder1",
	122: "JerhynPlaceHolder2",
	123: "InnerHellShrine2",
	124: "InnerHellShrine3",
	125: "InnerHellHiddenStash",
	126: "InnerHellSkullPile",
	127: "InnerHellHiddenStash2",
	128: "InnerHellHiddenStash3",
	129: "SecretDoor1",
	130: "Act1WildernessWell",
	131: "VileDogAfterglow",
	132: "CathedralWell",
	133: "ArcaneSanctuaryShrine",
	134: "DesertShrine2",
	135: "DesertShrine3",
	136: "DesertShrine1",
	137: "DesertWell",
	138: "CaveWell",
	139: "Act1LargeChestRight",
	140: "Act1TallChestRight",
	141: "Act1MediumChestRight",
	142: "DesertJug1",
	143: "DesertJug2",
	144: "Act1LargeChest1",
	145: "InnerHellWaypoint",
	146: "Act2MediumChestRight",
	147: "Act2LargeChestRight",
	148: "Act2LargeChestLeft",
	149: "TaintedSunAltar",
	150: "DesertShrine5",
	151: "DesertShrine4",
	152: "HoradricOrifice",
	153: "TyraelsDoor",
	154: "GuardCorpse",
	155: "HiddenStashRock",
	156: "Act2Waypoint",
	157: "Act1WildernessWaypoint",
	158: "SkeletonCorpseIsAnOxymoron",
	159: "HiddenStashRockB",
	160: "SmallFire",
	161: "MediumFire",
	162: "LargeFire",
	163: "Act1CliffHidingSpot",
	164: "ManaWell1",
	165: "ManaWell2",
	166: "ManaWell3",
	167: "ManaWell4",
	168: "ManaWell5",
	169: "HollowLog",
	170: "JungleHealWell",
	171: "SkeletonCorpseIsStillAnOxymoron",
	172: "DesertHealthShrine",
	173: "ManaWell7",
	174: "LooseRock",
	175: "LooseBoulder",
	176: "MediumChestLeft",
	177: "LargeChestLeft2",
	178: "GuardCorpseOnAStick",
	179: "Bookshelf1",
	180: "Bookshelf2",
	181: "JungleChest",
	182: "TombCoffin",
	183: "JungleMediumChestLeft",
	184: "JungleShrine2",
	185: "JungleStashObject1",
	186: "JungleStashObject2",
	187: "JungleStashObject3",
	188: "JungleStashObject4",
	189: "DummyCainPortal",
	190: "JungleShrine3",
	191: "JungleShrine4",
	192: "TeleportationPad1",
	193: "LamEsensTome",
	194: "StairsL",
	195: "StairsR",
	196: "FloorTrap",
	197: "JungleShrine5",
	198: "TallChestLeft",
	199: "MephistoShrine1",
	200: "MephistoShrine2",
	201: "MephistoShrine3",
	202: "MephistoManaShrine",
	203: "MephistoLair",
	204: "StashBox",
	205: "StashAltar",
	206: "MafistoHealthShrine",
	207: "Act3WaterRocks",
	208: "Basket1",
	209: "Basket2",
	210: "Act3WaterLogs",
	211: "Act3WaterRocksGirl",
	212: "Act3WaterBubbles",
	213: "Act3WaterLogsX",
	214: "Act3WaterRocksB",
	215: "Act3WaterRocksGirlC",
	216: "Act3WaterRocksY",
	217: "Act3WaterLogsZ",
	218: "WebCoveredTree1",
	219: "WebCoveredTree2",
	220: "WebCoveredTree3",
	221: "WebCoveredTree4",
	222: "Pillar",
	223: "Cocoon",
	224: "Cocoon2",
	225: "SkullPileH1",
	226: "OuterHellShrine",
	227: "Act3WaterRocksGirlW",
	228: "Act3BigLog",
	229: "SlimeDoor1",
	230: "SlimeDoor2",
	231: "OuterHellShrine2",
	232: "OuterHellShrine3",
	233: "PillarH2",
	234: "Act3BigLogC",
	235: "Act3BigLogD",
	236: "HellHealthShrine",
	237: "Act3TownWaypoint",
	238: "WaypointH",
	239: "BurningBodyTown",
	240: "Gchest1L",
	241: "Gchest2R",
	242: "Gchest3R",
	243: "GLchest3L",
	244: "SewersRatNest",
	245: "BurningBodyTown2",
	246: "SewersRatNest2",
	247: "Act1BedBed1",
	248: "Act1BedBed2",
	249: "HellManaShrine",
	250: "ExplodingCow",
	251: "GidbinnAltar",
	252: "GidbinnAltarDecoy",
	253: "DiabloRightLight",
	254: "DiabloLeftLight",
	255: "DiabloStartPoint",
	256: "Act1CabinStool",
	257: "Act1CabinWood",
	258: "Act1CabinWood2",
	259: "HellSkeletonSpawnNW",
	260: "Act1HolyShrine",
	261: "TombsFloorTrapSpikes",
	262: "Act1CathedralShrine",
	263: "Act1JailShrine1",
	264: "Act1JailShrine2",
	265: "Act1JailShrine3",
	266: "MaggotLairGooPile",
	267: "Bank",
	268: "WirtCorpse",
	269: "GoldPlaceHolder",
	270: "GuardCorpse2",
	271: "DeadVillager1",
	272: "DeadVillager2",
	273: "DummyFlameNoDamage",
	274: "TinyPixelShapedThingie",
	275: "CavesHealthShrine",
	276: "CavesManaShrine",
	277: "CaveMagicShrine",
	278: "Act3DungeonManaShrine",
	279: "Act3SewersMagicShrine1",
	280: "Act3SewersHealthWell",
	281: "Act3SewersManaWell",
	282: "Act3SewersMagicShrine2",
	283: "Act2BrazierCeller",
	284: "Act2TombAnubisCoffin",
	285: "Act2Brazier",
	286: "Act2BrazierTall",
	287: "Act2BrazierSmall",
	288: "Act2CellerWaypoint",
	289: "HarumBedBed",
	290: "IronGrateDoorLeft",
	291: "IronGrateDoorRight",
	292: "WoodenGrateDoorLeft",
	293: "WoodenGrateDoorRight",
	294: "WoodenDoorLeft",
	295: "WoodenDoorRight",
	296: "TombsWallTorchLeft",
	297: "TombsWallTorchRight",
	298: "ArcaneSanctuaryPortal",
	299: "Act2HaramMagicShrine1",
	300: "Act2HaramMagicShrine2",
	301: "MaggotHealthWell",
	302: "MaggotManaWell",
	303: "ArcaneSanctuaryMagicShrine",
	304: "TeleportationPad2",
	305: "TeleportationPad3",
	306: "TeleportationPad4",
	307: "DummyArcaneThing1",
	308: "DummyArcaneThing2",
	309: "DummyArcaneThing3",
	310: "DummyArcaneThing4",
	311: "DummyArcaneThing5",
	312: "DummyArcaneThing6",
	313: "DummyArcaneThing7",
	314: "HaremDeadGuard1",
	315: "HaremDeadGuard2",
	316: "HaremDeadGuard3",
	317: "HaremDeadGuard4",
	318: "HaremEunuchBlocker",
	319: "ArcaneHealthWell",
	320: "ArcaneManaWell",
	321: "TestData2",
	322: "Act2TombWell",
	323: "Act2SewerWaypoint",
	324: "Act3TravincalWaypoint",
	325: "Act3SewerMagicShrine",
	326: "Act3SewerDeadBody",
	327: "Act3SewerTorch",
	328: "Act3KurastTorch",
	329: "MafistoLargeChestLeft",
	330: "MafistoLargeChestRight",
	331: "MafistoMediumChestLeft",
	332: "MafistoMediumChestRight",
	333: "SpiderLairLargeChestLeft",
	334: "SpiderLairTallChestLeft",
	335: "SpiderLairMediumChestRight",
	336: "SpiderLairTallChestRight",
	337: "SteegStone",
	338: "GuildVault",
	339: "TrophyCase",
	340: "MessageBoard",
	341: "MephistoBridge",
	342: "HellGate",
	343: "Act3KurastManaWell",
	344: "Act3KurastHealthWell",
	345: "HellFire1",
	346: "HellFire2",
	347: "HellFire3",
	348: "HellLava1",
	349: "HellLava2",
	350: "HellLava3",
	351: "HellLightSource1",
	352: "HellLightSource2",
	353: "HellLightSource3",
	354: "HoradricCubeChest",
	355: "HoradricScrollChest",
	356: "StaffOfKingsChest",
	357: "YetAnotherTome",
	358: "HellBrazier1",
	359: "HellBrazier2",
	360: "DungeonRockPile",
	361: "Act3DungeonMagicShrine",
	362: "Act3DungeonBasket",
	363: "OuterHellHungSkeleton",
	364: "GuyForDungeon",
	365: "Act3DungeonCasket",
	366: "Act3SewerStairs",
	367: "Act3SewerStairsToLevel3",
	368: "DarkWandererStartPosition",
	369: "TrappedSoulPlaceHolder",
	370: "Act3TownTorch",
	371: "LargeChestR",
	372: "InnerHellBoneChest",
	373: "HellSkeletonSpawnNE",
	374: "Act3WaterFog",
	375: "DummyNotUsed",
	376: "HellForge",
	377: "GuildPortal",
	378: "HratliStartPosition",
	379: "HratliEndPosition",
	380: "BurningTrappedSoul1",
	381: "BurningTrappedSoul2",
	382: "NatalyaStartPosition",
	383: "StuckedTrappedSoul1",
	384: "StuckedTrappedSoul2",
	385: "CainStartPosition",
	386: "StairSR",
	387: "ArcaneLargeChestLeft",
	388: "ArcaneCasket",
	389: "ArcaneLargeChestRight",
	390: "ArcaneSmallChestLeft",
	391: "ArcaneSmallChestRight",
	392: "DiabloSeal1",
	393: "DiabloSeal2",
	394: "DiabloSeal3",
	395: "DiabloSeal4",
	396: "DiabloSeal5",
	397: "SparklyChest",
	398: "PandamoniumFortressWaypoint",
	399: "InnerHellFissure",
	400: "HellMesaBrazier",
	401: "Smoke",
	402: "ValleyWaypoint",
	403: "HellBrazier3",
	404: "CompellingOrb",
	405: "KhalimChest1",
	406: "KhalimChest2",
	407: "KhalimChest3",
	408: "SiegeMachineControl",
	409: "PotOTorch",
	410: "PyoxFirePit",
	413: "ExpansionChestRight",
	414: "ExpansionWildernessShrine1",
	415: "ExpansionWildernessShrine2",
	416: "ExpansionHiddenStash",
	417: "ExpansionWildernessFlag",
	418: "ExpansionWildernessBarrel",
	419: "ExpansionSiegeBarrel",
	420: "ExpansionWoodChestLeft",
	421: "ExpansionWildernessShrine3",
	422: "ExpansionManaShrine",
	423: "ExpansionHealthShrine",
	424: "BurialChestLeft",
	425: "BurialChestRight",
	426: "ExpansionWell",
	427: "ExpansionWildernessShrine4",
	428: "ExpansionWildernessShrine5",
	429: "ExpansionWaypoint",
	430: "ExpansionChestLeft",
	431: "ExpansionWoodChestRight",
	432: "ExpansionSmallChestLeft",
	433: "ExpansionSmallChestRight",
	434: "ExpansionTorch1",
	435: "ExpansionCampFire",
	436: "ExpansionTownTorch",
	437: "ExpansionTorch2",
	438: "ExpansionBurningBodies",
	439: "ExpansionBurningPit",
	440: "ExpansionTribalFlag",
	441: "ExpansionTownFlag",
	442: "ExpansionChandelier",
	443: "ExpansionJar1",
	444: "ExpansionJar2",
	445: "ExpansionJar3",
	446: "ExpansionSwingingHeads",
	447: "ExpansionWildernessPole",
	448: "AnimatedSkullAndRockPile",
	449: "ExpansionTownGate",
	450: "SkullAndRockPile",
	451: "SiegeHellGate",
	452: "EnemyCampBanner1",
	453: "EnemyCampBanner2",
	454: "ExpansionExplodingChest",
	455: "ExpansionSpecialChest",
	456: "ExpansionDeathPole",
	457: "ExpansionDeathPoleLeft",
	458: "TempleAltar",
	459: "DrehyaTownStartPosition",
	460: "DrehyaWildernessStartPosition",
	461: "NihlathakTownStartPosition",
	462: "NihlathakWildernessStartPosition",
	463: "IceCaveHiddenStash",
	464: "IceCaveHealthShrine",
	465: "IceCaveManaShrine",
	466: "IceCaveEvilUrn",
	467: "IceCaveJar1",
	468: "IceCaveJar2",
	469: "IceCaveJar3",
	470: "IceCaveJar4",
	471: "IceCaveJar5",
	472: "IceCaveMagicShrine",
	473: "CagedWussie",
	474: "AncientStatue3",
	475: "AncientStatue1",
	476: "AncientStatue2",
	477: "DeadBarbarian",
	478: "ClientSmoke",
	479: "IceCaveMagicShrine2",
	480: "IceCaveTorch1",
	481: "IceCaveTorch2",
	482: "ExpansionTikiTorch",
	483: "WorldstoneManaShrine",
	484: "WorldstoneHealthShrine",
	485: "WorldstoneTomb1",
	486: "WorldstoneTomb2",
	487: "WorldstoneTomb3",
	488: "WorldstoneMagicShrine",
	489: "WorldstoneTorch1",
	490: "WorldstoneTorch2",
	491: "ExpansionSnowyManaShrine1",
	492: "ExpansionSnowyHealthShrine",
	493: "ExpansionSnowyWell",
	494: "WorldstoneWaypoint",
	495: "ExpansionSnowyMagicShrine2",
	496: "ExpansionWildernessWaypoint",
	497: "ExpansionSnowyMagicShrine3",
	498: "WorldstoneWell",
	499: "WorldstoneMagicShrine2",
	500: "ExpansionSnowyObject1",
	501: "ExpansionSnowyWoodChestLeft",
	502: "ExpansionSnowyWoodChestRight",
	503: "WorldstoneMagicShrine3",
	504: "ExpansionSnowyWoodChest2Left",
	505: "ExpansionSnowyWoodChest2Right",
	506: "SnowySwingingHeads",
	507: "SnowyDebris",
	508: "PenBreakableDoor",
	509: "ExpansionTempleMagicShrine1",
	510: "ExpansionSnowyPoleMR",
	511: "IceCaveWaypoint",
	512: "ExpansionTempleMagicShrine2",
	513: "ExpansionTempleWell",
	514: "ExpansionTempleTorch1",
	515: "ExpansionTempleTorch2",
	516: "ExpansionTempleObject1",
	517: "ExpansionTempleObject2",
	518: "WorldstoneMrBox",
	519: "IceCaveWell",
	520: "ExpansionTempleMagicShrine",
	521: "ExpansionTempleHealthShrine",
	522: "ExpansionTempleManaShrine",
	523: "BlacksmithForge",
	524: "WorldstoneTomb1Left",
	525: "WorldstoneTomb2Left",
	526: "WorldstoneTomb3Left",
	527: "IceCaveBubblesU",
	528: "IceCaveBubblesS",
	529: "RedBaalsLairTomb1",
	530: "RedBaalsLairTomb1Left",
	531: "RedBaalsLairTomb2",
	532: "RedBaalsLairTomb2Left",
	533: "RedBaalsLairTomb3",
	534: "RedBaalsLairTomb3Left",
	535: "RedBaalsLairMrBox",
	536: "RedBaalsLairTorch1",
	537: "RedBaalsLairTorch2",
	538: "CandlesTemple",
	539: "TempleWaypoint",
	540: "ExpansionDeadPerson1",
	541: "TempleGroundTomb",
	542: "LarzukGreeting",
	543: "LarzukStandard",
	544: "TempleGroundTombLeft",
	545: "ExpansionDeadPerson2",
	546: "AncientsAltar",
	547: "ArreatSummitDoorToWorldstone",
	548: "ExpansionWeaponRackRight",
	549: "ExpansionWeaponRackLeft",
	550: "ExpansionArmorStandRight",
	551: "ExpansionArmorStandLeft",
	552: "ArreatsSummitTorch2",
	553: "ExpansionFuneralSpire",
	554: "ExpansionBurningLogs",
	555: "IceCaveSteam",
	556: "ExpansionDeadPerson3",
	557: "BaalsLair",
	558: "FrozenAnya",
	559: "BBQBunny",
	560: "BaalTorchBig",
	561: "InvisibleAncient",
	562: "InvisibleBase",
	563: "BaalsPortal",
	564: "ArreatSummitDoor",
	565: "LastPortal",
	566: "LastLastPortal",
	567: "ZooTestData",
	568: "KeeperTestData",
	569: "BaalsPortal2",
	570: "FirePlaceGuy",
	571: "DoorBlocker1",
	572: "DoorBlocker2",
	580: "GoodChest",
	581: "NotSoGoodChest",
}

var ChestStatesMap = map[int]string{
	0:   "",
	4:   "trap",
	128: "locked",
}
